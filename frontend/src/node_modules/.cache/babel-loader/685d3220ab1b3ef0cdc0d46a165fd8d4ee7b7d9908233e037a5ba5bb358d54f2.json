{"ast":null,"code":"const STORAGE_KEY = \"@chamados-ti:chamados\";\n\n/* =========================\n   STATUS\n========================= */\nexport const STATUS_CHAMADO = {\n  ABERTO: \"ABERTO\",\n  EM_ATENDIMENTO: \"EM_ATENDIMENTO\",\n  AGUARDANDO_CLIENTE: \"AGUARDANDO_CLIENTE\",\n  AGUARDANDO_TERCEIRO: \"AGUARDANDO_TERCEIRO\",\n  RESOLVIDO: \"RESOLVIDO\",\n  FECHADO: \"FECHADO\"\n};\n\n/* =========================\n   PRIORIDADE\n========================= */\nexport const PRIORIDADE = {\n  BAIXA: \"BAIXA\",\n  MEDIA: \"MEDIA\",\n  ALTA: \"ALTA\",\n  CRITICA: \"CRITICA\"\n};\n\n/* =========================\n   PRIORIDADE AUTOMÁTICA\n========================= */\nfunction calcularPrioridade(categoria, impacto) {\n  if (impacto === \"ALTO\") return PRIORIDADE.CRITICA;\n  if (categoria === \"INFRA\") return PRIORIDADE.ALTA;\n  return PRIORIDADE.MEDIA;\n}\n\n/* =========================\n   SLA (HORAS)\n========================= */\nfunction calcularSLA(prioridade) {\n  switch (prioridade) {\n    case PRIORIDADE.CRITICA:\n      return 4;\n    case PRIORIDADE.ALTA:\n      return 8;\n    case PRIORIDADE.MEDIA:\n      return 24;\n    default:\n      return 48;\n  }\n}\n\n/* =========================\n   UTIL\n========================= */\nfunction getStorage() {\n  return JSON.parse(localStorage.getItem(STORAGE_KEY) || \"[]\");\n}\nfunction setStorage(dados) {\n  localStorage.setItem(STORAGE_KEY, JSON.stringify(dados));\n}\n\n/* =========================\n   LISTAGEM\n========================= */\nexport async function listarChamados(empresaId) {\n  const chamados = getStorage();\n  return chamados.filter(c => c.empresaId === empresaId).map(c => ({\n    ...c,\n    historico: Array.isArray(c.historico) ? c.historico : [],\n    comentarios: Array.isArray(c.comentarios) ? c.comentarios : []\n  }));\n}\n\n/* =========================\n   CRIAÇÃO\n========================= */\nexport async function salvarChamado(empresaId, dados) {\n  const chamados = getStorage();\n  const prioridade = calcularPrioridade(dados.categoria, dados.impacto);\n  const agora = new Date().toISOString();\n  const novoChamado = {\n    id: crypto.randomUUID(),\n    empresaId,\n    responsavel: dados.responsavel || \"\",\n    demanda: dados.demanda || \"\",\n    categoria: dados.categoria || \"SUPORTE\",\n    impacto: dados.impacto || \"MEDIO\",\n    obs: dados.obs || \"\",\n    status: STATUS_CHAMADO.ABERTO,\n    prioridade,\n    slaHoras: calcularSLA(prioridade),\n    criadoEm: agora,\n    fechadoEm: null,\n    historico: [{\n      data: agora,\n      acao: \"Chamado criado\"\n    }],\n    comentarios: []\n  };\n  chamados.push(novoChamado);\n  setStorage(chamados);\n  return novoChamado;\n}\n\n/* =========================\n   ATUALIZAÇÃO + AUDITORIA\n========================= */\nexport async function atualizarChamadoStorage(empresaId, id, dadosAtualizados) {\n  const chamados = getStorage();\n  const index = chamados.findIndex(c => c.id === id && c.empresaId === empresaId);\n  if (index === -1) {\n    throw new Error(\"Chamado não encontrado\");\n  }\n  const chamadoAtual = chamados[index];\n  const historicoAtual = Array.isArray(chamadoAtual.historico) ? chamadoAtual.historico : [];\n  const agora = new Date().toISOString();\n  const chamadoAtualizado = {\n    ...chamadoAtual,\n    ...dadosAtualizados,\n    historico: [...historicoAtual, {\n      data: agora,\n      acao: \"Chamado atualizado\"\n    }],\n    fechadoEm: dadosAtualizados.status === STATUS_CHAMADO.FECHADO ? agora : chamadoAtual.fechadoEm\n  };\n  chamados[index] = chamadoAtualizado;\n  setStorage(chamados);\n  return chamadoAtualizado;\n}\nexport async function excluirChamadoStorage(empresaId, id) {\n  const chamados = JSON.parse(localStorage.getItem(\"@chamados-ti:chamados\") || \"[]\");\n  const filtrados = chamados.filter(c => !(c.id === id && c.empresaId === empresaId));\n  localStorage.setItem(\"@chamados-ti:chamados\", JSON.stringify(filtrados));\n  return true;\n}","map":{"version":3,"names":["STORAGE_KEY","STATUS_CHAMADO","ABERTO","EM_ATENDIMENTO","AGUARDANDO_CLIENTE","AGUARDANDO_TERCEIRO","RESOLVIDO","FECHADO","PRIORIDADE","BAIXA","MEDIA","ALTA","CRITICA","calcularPrioridade","categoria","impacto","calcularSLA","prioridade","getStorage","JSON","parse","localStorage","getItem","setStorage","dados","setItem","stringify","listarChamados","empresaId","chamados","filter","c","map","historico","Array","isArray","comentarios","salvarChamado","agora","Date","toISOString","novoChamado","id","crypto","randomUUID","responsavel","demanda","obs","status","slaHoras","criadoEm","fechadoEm","data","acao","push","atualizarChamadoStorage","dadosAtualizados","index","findIndex","Error","chamadoAtual","historicoAtual","chamadoAtualizado","excluirChamadoStorage","filtrados"],"sources":["/home/diniz_jessica/development/chamados-ti/src/services/chamadosService.js"],"sourcesContent":["const STORAGE_KEY = \"@chamados-ti:chamados\";\n\n/* =========================\n   STATUS\n========================= */\nexport const STATUS_CHAMADO = {\n  ABERTO: \"ABERTO\",\n  EM_ATENDIMENTO: \"EM_ATENDIMENTO\",\n  AGUARDANDO_CLIENTE: \"AGUARDANDO_CLIENTE\",\n  AGUARDANDO_TERCEIRO: \"AGUARDANDO_TERCEIRO\",\n  RESOLVIDO: \"RESOLVIDO\",\n  FECHADO: \"FECHADO\",\n};\n\n/* =========================\n   PRIORIDADE\n========================= */\nexport const PRIORIDADE = {\n  BAIXA: \"BAIXA\",\n  MEDIA: \"MEDIA\",\n  ALTA: \"ALTA\",\n  CRITICA: \"CRITICA\",\n};\n\n/* =========================\n   PRIORIDADE AUTOMÁTICA\n========================= */\nfunction calcularPrioridade(categoria, impacto) {\n  if (impacto === \"ALTO\") return PRIORIDADE.CRITICA;\n  if (categoria === \"INFRA\") return PRIORIDADE.ALTA;\n  return PRIORIDADE.MEDIA;\n}\n\n/* =========================\n   SLA (HORAS)\n========================= */\nfunction calcularSLA(prioridade) {\n  switch (prioridade) {\n    case PRIORIDADE.CRITICA:\n      return 4;\n    case PRIORIDADE.ALTA:\n      return 8;\n    case PRIORIDADE.MEDIA:\n      return 24;\n    default:\n      return 48;\n  }\n}\n\n/* =========================\n   UTIL\n========================= */\nfunction getStorage() {\n  return JSON.parse(localStorage.getItem(STORAGE_KEY) || \"[]\");\n}\n\nfunction setStorage(dados) {\n  localStorage.setItem(STORAGE_KEY, JSON.stringify(dados));\n}\n\n/* =========================\n   LISTAGEM\n========================= */\nexport async function listarChamados(empresaId) {\n  const chamados = getStorage();\n\n  return chamados\n    .filter(c => c.empresaId === empresaId)\n    .map(c => ({\n      ...c,\n      historico: Array.isArray(c.historico) ? c.historico : [],\n      comentarios: Array.isArray(c.comentarios) ? c.comentarios : [],\n    }));\n}\n\n/* =========================\n   CRIAÇÃO\n========================= */\nexport async function salvarChamado(empresaId, dados) {\n  const chamados = getStorage();\n\n  const prioridade = calcularPrioridade(\n    dados.categoria,\n    dados.impacto\n  );\n\n  const agora = new Date().toISOString();\n\n  const novoChamado = {\n    id: crypto.randomUUID(),\n    empresaId,\n\n    responsavel: dados.responsavel || \"\",\n    demanda: dados.demanda || \"\",\n    categoria: dados.categoria || \"SUPORTE\",\n    impacto: dados.impacto || \"MEDIO\",\n    obs: dados.obs || \"\",\n\n    status: STATUS_CHAMADO.ABERTO,\n    prioridade,\n    slaHoras: calcularSLA(prioridade),\n\n    criadoEm: agora,\n    fechadoEm: null,\n\n    historico: [\n      {\n        data: agora,\n        acao: \"Chamado criado\",\n      },\n    ],\n\n    comentarios: [],\n  };\n\n  chamados.push(novoChamado);\n  setStorage(chamados);\n\n  return novoChamado;\n}\n\n/* =========================\n   ATUALIZAÇÃO + AUDITORIA\n========================= */\nexport async function atualizarChamadoStorage(\n  empresaId,\n  id,\n  dadosAtualizados\n) {\n  const chamados = getStorage();\n\n  const index = chamados.findIndex(\n    c => c.id === id && c.empresaId === empresaId\n  );\n\n  if (index === -1) {\n    throw new Error(\"Chamado não encontrado\");\n  }\n\n  const chamadoAtual = chamados[index];\n\n  const historicoAtual = Array.isArray(chamadoAtual.historico)\n    ? chamadoAtual.historico\n    : [];\n\n  const agora = new Date().toISOString();\n\n  const chamadoAtualizado = {\n    ...chamadoAtual,\n    ...dadosAtualizados,\n    historico: [\n      ...historicoAtual,\n      {\n        data: agora,\n        acao: \"Chamado atualizado\",\n      },\n    ],\n    fechadoEm:\n      dadosAtualizados.status === STATUS_CHAMADO.FECHADO\n        ? agora\n        : chamadoAtual.fechadoEm,\n  };\n\n  chamados[index] = chamadoAtualizado;\n  setStorage(chamados);\n\n  return chamadoAtualizado;\n}\nexport async function excluirChamadoStorage(empresaId, id) {\n  const chamados = JSON.parse(\n    localStorage.getItem(\"@chamados-ti:chamados\") || \"[]\"\n  );\n\n  const filtrados = chamados.filter(\n    c => !(c.id === id && c.empresaId === empresaId)\n  );\n\n  localStorage.setItem(\n    \"@chamados-ti:chamados\",\n    JSON.stringify(filtrados)\n  );\n\n  return true;\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}