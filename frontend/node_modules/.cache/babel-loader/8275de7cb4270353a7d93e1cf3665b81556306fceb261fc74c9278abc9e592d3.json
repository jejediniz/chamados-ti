{"ast":null,"code":"var _jsxFileName = \"/home/diniz_jessica/development/chamados-ti/frontend/src/contextos/authContext.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport { createContext, useContext, useEffect, useState, useCallback } from \"react\";\nimport api, { setUnauthorizedHandler } from \"../services/api\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AuthContext = /*#__PURE__*/createContext(null);\nconst STORAGE_KEY = \"@chamados-ti:auth\";\nconst TOKEN_KEY = \"token\";\nexport function AuthProvider({\n  children\n}) {\n  _s();\n  const [usuario, setUsuario] = useState(null);\n  const [carregando, setCarregando] = useState(true);\n  const [erro, setErro] = useState(null);\n\n  /**\n   * Recupera sessÃ£o salva\n   */\n  useEffect(() => {\n    const dadosSalvos = sessionStorage.getItem(STORAGE_KEY);\n    if (dadosSalvos) {\n      try {\n        const {\n          usuario\n        } = JSON.parse(dadosSalvos);\n        setUsuario(usuario);\n      } catch {\n        sessionStorage.removeItem(STORAGE_KEY);\n      }\n    }\n    setCarregando(false);\n  }, []);\n\n  /**\n   * Persiste sessÃ£o\n   */\n  useEffect(() => {\n    if (usuario) {\n      sessionStorage.setItem(STORAGE_KEY, JSON.stringify({\n        usuario\n      }));\n    } else {\n      sessionStorage.removeItem(STORAGE_KEY);\n    }\n  }, [usuario]);\n\n  /**\n   * LOGIN REAL (BACKEND)\n   */\n  async function login(email, senha) {\n    setCarregando(true);\n    setErro(null);\n    try {\n      const response = await api.post(\"/auth/login\", {\n        email,\n        senha\n      });\n      const {\n        token,\n        usuario\n      } = response.data.data;\n\n      // ðŸ”‘ salva o token para as prÃ³ximas requisiÃ§Ãµes\n      sessionStorage.setItem(TOKEN_KEY, token);\n      setUsuario(usuario);\n      return true;\n    } catch (error) {\n      setErro(error.message || \"Email ou senha invÃ¡lidos\");\n      return false;\n    } finally {\n      setCarregando(false);\n    }\n  }\n\n  /**\n   * LOGOUT\n   */\n  const logout = useCallback(() => {\n    sessionStorage.removeItem(TOKEN_KEY);\n    setUsuario(null);\n  }, []);\n  useEffect(() => {\n    setUnauthorizedHandler(() => logout());\n  }, [logout]);\n  const estaAutenticado = Boolean(usuario);\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: {\n      usuario,\n      estaAutenticado,\n      carregando,\n      erro,\n      login,\n      logout\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 89,\n    columnNumber: 5\n  }, this);\n}\n_s(AuthProvider, \"r+YBDh5lC+WV7bK6sQeIh/WKOqI=\");\n_c = AuthProvider;\nexport function useAuth() {\n  _s2();\n  const ctx = useContext(AuthContext);\n  if (!ctx) {\n    throw new Error(\"useAuth deve ser usado dentro de AuthProvider\");\n  }\n  return ctx;\n}\n_s2(useAuth, \"/dMy7t63NXD4eYACoT93CePwGrg=\");\nvar _c;\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"names":["createContext","useContext","useEffect","useState","useCallback","api","setUnauthorizedHandler","jsxDEV","_jsxDEV","AuthContext","STORAGE_KEY","TOKEN_KEY","AuthProvider","children","_s","usuario","setUsuario","carregando","setCarregando","erro","setErro","dadosSalvos","sessionStorage","getItem","JSON","parse","removeItem","setItem","stringify","login","email","senha","response","post","token","data","error","message","logout","estaAutenticado","Boolean","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_c","useAuth","_s2","ctx","Error","$RefreshReg$"],"sources":["/home/diniz_jessica/development/chamados-ti/frontend/src/contextos/authContext.js"],"sourcesContent":["import { createContext, useContext, useEffect, useState, useCallback } from \"react\";\nimport api, { setUnauthorizedHandler } from \"../services/api\";\n\nconst AuthContext = createContext(null);\n\nconst STORAGE_KEY = \"@chamados-ti:auth\";\nconst TOKEN_KEY = \"token\";\n\nexport function AuthProvider({ children }) {\n  const [usuario, setUsuario] = useState(null);\n  const [carregando, setCarregando] = useState(true);\n  const [erro, setErro] = useState(null);\n\n  /**\n   * Recupera sessÃ£o salva\n   */\n  useEffect(() => {\n    const dadosSalvos = sessionStorage.getItem(STORAGE_KEY);\n\n    if (dadosSalvos) {\n      try {\n        const { usuario } = JSON.parse(dadosSalvos);\n        setUsuario(usuario);\n      } catch {\n        sessionStorage.removeItem(STORAGE_KEY);\n      }\n    }\n\n    setCarregando(false);\n  }, []);\n\n  /**\n   * Persiste sessÃ£o\n   */\n  useEffect(() => {\n    if (usuario) {\n      sessionStorage.setItem(\n        STORAGE_KEY,\n        JSON.stringify({ usuario })\n      );\n    } else {\n      sessionStorage.removeItem(STORAGE_KEY);\n    }\n  }, [usuario]);\n\n  /**\n   * LOGIN REAL (BACKEND)\n   */\n  async function login(email, senha) {\n    setCarregando(true);\n    setErro(null);\n\n    try {\n      const response = await api.post(\"/auth/login\", {\n        email,\n        senha,\n      });\n\n      const { token, usuario } = response.data.data;\n\n      // ðŸ”‘ salva o token para as prÃ³ximas requisiÃ§Ãµes\n      sessionStorage.setItem(TOKEN_KEY, token);\n\n      setUsuario(usuario);\n      return true;\n    } catch (error) {\n      setErro(error.message || \"Email ou senha invÃ¡lidos\");\n      return false;\n    } finally {\n      setCarregando(false);\n    }\n  }\n\n  /**\n   * LOGOUT\n   */\n  const logout = useCallback(() => {\n    sessionStorage.removeItem(TOKEN_KEY);\n    setUsuario(null);\n  }, []);\n\n  useEffect(() => {\n    setUnauthorizedHandler(() => logout());\n  }, [logout]);\n\n  const estaAutenticado = Boolean(usuario);\n\n  return (\n    <AuthContext.Provider\n      value={{\n        usuario,\n        estaAutenticado,\n        carregando,\n        erro,\n        login,\n        logout,\n      }}\n    >\n      {children}\n    </AuthContext.Provider>\n  );\n}\n\nexport function useAuth() {\n  const ctx = useContext(AuthContext);\n  if (!ctx) {\n    throw new Error(\"useAuth deve ser usado dentro de AuthProvider\");\n  }\n  return ctx;\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}